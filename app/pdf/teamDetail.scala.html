@(ligue: model.orga.Ligue, detail: model.team.MatchDetail)

@import model.team._
@import model.orga.TeamParticipant

@displayTeam(tmd: TeamMatchDetail) = {
    <table class="full grey">
        <caption>@tmd.team</caption>
        <tr><th colspan="3">@Messages("team.detail.players")</th></tr>
        @for(i <- 1 to 4) {
        <tr>
            <th>@i</th>
            <td class="white">@tmd.players(i - 1).name</td>
            <td class="license">@tmd.players(i - 1).licenseNumber</td>
        </tr>
        }
    </table>
    <table class="full grey">
        <tr><th colspan="2">@Messages("team.detail.doublettes")</th></tr>
        <tr>
            <th>1</th>
            <td class="white">@tmd.doublettes._1.name</td>
        </tr>
        <tr>
            <th>2</th>
            <td class="white">@tmd.doublettes._2.name</td>
        </tr>
    </table>
    <table class="full grey">
        <tr>
            <th style="width: 30%">@Messages("team.detail.substitute")</th>
            <td class="white" >@tmd.substitute.map(_.player.name)</td>
            <td class="license">@tmd.substitute.map(_.player.licenseNumber)</td>
        </tr>
        <tr>
            <th>@Messages("team.detail.substitute.who")</th>
            <td class="white" colspan="2" width="*">@tmd.substitute.map(_.replace.map(_.name))</td>
        </tr>
        <tr>
            <th>@Messages("team.detail.substitute.after")</th>
            <td class="white" colspan="2" width="*">@tmd.substitute.map(_.afterMatch.getOrElse(""))</td>
        </tr>
    </table>
}

@leg(player: TeamParticipant, leg: Leg) = {
    @if(leg.winner == player) {
        <img class="white" src="@routes.Assets.at("ico/check.png")"/>
    } else {
        <img class="white" src="@routes.Assets.at("ico/unchecked.png")"/>
    }
}

@displayMatch(i: Int, m: Match) = {
    <table class="match full grey">
        <caption>@Messages("team.detail.match",i)</caption>
        <tr>
            <th colspan="3">
                @if(m.player1Start) {<strong>*</strong>}
                @m.player1.name
            </th>
        </tr>
        <tr>
            <td>@leg(m.player1, m.legs._1)</td>
            <td>@leg(m.player1, m.legs._2)</td>
            <td>
                @if(m.legs._3.isDefined) {
                    @leg(m.player1, m.legs._3.get)
                } else {
                    <img src="@routes.Assets.at("ico/unchecked.png")"/>
                }
            </td>
        </tr>
        <tr>
            <td >@leg(m.player2, m.legs._1)</td>
            <td >@leg(m.player2, m.legs._2)</td>
            <td >
                @if(m.legs._3.isDefined) {
                    @leg(m.player2, m.legs._3.get)
                } else {
                    <img src="@routes.Assets.at("ico/unchecked.png")"/>
                }
            </td>
        </tr>
        <tr>
            <th colspan="3">
                @if(!m.player1Start) {<strong>*</strong>}
                @m.player2.name
            </th>
        </tr>
    </table>
}

@layout.pdf() {
    @detail match {
        case MatchDetailFail(_, _, _, fails) => {
            @Messages("team.detail.fail", fails)
        }
        case PlayedMatchDetail(day, date, location, team1, team2, matches) => {
            <h2>
                @Messages("championship.day.caption", day) -
            <span class="@tags.winLooseDraw(detail.plus(team1.team), detail.plus(team2.team))">@team1.team</span>
                vs.
            <span class="@tags.winLooseDraw(detail.plus(team2.team), detail.plus(team1.team))">@team2.team</span>
            </h2>

            <table class="full">
                <tr>
                    <td><strong>@Messages("team.detail.day")</strong>: <div class="white" style="display: inline-block">&nbsp;@detail.day&nbsp;&nbsp;</div></td>
                    <td><strong>@Messages("team.detail.date")</strong>: <div class="white" style="display: inline-block">&nbsp;@tags.date(date)&nbsp;&nbsp;</div></td>
                    <td><strong>@Messages("team.detail.location")</strong>: <div class="white" style="display: inline-block">&nbsp;@location&nbsp;&nbsp;</div></td>
                </tr>
            </table>

            <!-- team -->
            <table class="full">
                <tr>
                    <td class="bordered">@displayTeam(team1)</td>
                    <td class="bordered">@displayTeam(team2)</td>
                </tr>
            </table>
            <hr/>
            <table class="full">
                <tr>
                    <td>
                            <!-- match -->
                        <table id="matches">
                        @for(i <- 0 to 3) {
                            <tr>
                            @for(j <- 0 to 4) {
                                <td valign="top">@displayMatch((4 * i) + j + 1, matches((4 * i) + j))</td>
                            }
                            </tr>
                        }
                        </table>
                    </td>
                    <td valign="top">
                            <!-- match2 -->
                        <table class="grey">
                            <caption>@Messages("team.detail.score")</caption>
                            @for(i <- 1 to 20) {
                                <tr>
                                    <td>
                                    @if(matches(i - 1).teamWinner == team1.team) {
                                        <img src="@routes.Assets.at("ico/check.png")"/>
                                    } else {
                                        <img src="@routes.Assets.at("ico/unchecked.png")"/>
                                    }
                                    </td>
                                    <td><strong>@i</strong></td>
                                    <td>
                                    @if(matches(i - 1).teamWinner == team2.team) {
                                        <img src="@routes.Assets.at("ico/check.png")"/>
                                    } else {
                                        <img src="@routes.Assets.at("ico/unchecked.png")"/>
                                    }

                                    </td>
                                </tr>
                            }
                        </table>
                    </td>
                </tr>
            </table>
            <!-- <hr/>-->
            <table class="full">
                <tr>
                    <td valign="top">
                        <!-- Results -->
                        <table class="bordered result full grey">
                            <caption>@Messages("team.detail.result")</caption>
                            <thead>
                                <tr>
                                    <th>@team1.team.name</th>
                                    <th></th>
                                    <th>@team2.team.name</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="@tags.winLooseDraw(detail.plus(team1.team), detail.plus(team2.team))">
                                    @detail.plus(team1.team)
                                    </td>
                                    <th>@Messages("team.detail.matches")</th>
                                    <td class="@tags.winLooseDraw(detail.plus(team2.team), detail.plus(team1.team))">
                                    @detail.plus(team2.team)
                                    </td>
                                </tr>
                                <tr>
                                    <td class="@tags.winLooseDraw(detail.legs(team1.team), detail.legs(team2.team))">
                                    @detail.legs(team1.team)
                                    </td>
                                    <th>@Messages("team.detail.legs")</th>
                                    <td class="@tags.winLooseDraw(detail.legs(team2.team), detail.legs(team1.team))">
                                    @detail.legs(team2.team)
                                    </td>
                                </tr>
                                <tr>
                                    <td class="@tags.winLooseDraw(detail.points(team1.team), detail.points(team2.team))">
                                    @detail.points(team1.team)
                                    </td>
                                    <th>@Messages("team.detail.points")</th>
                                    <td class="@tags.winLooseDraw(detail.points(team2.team), detail.points(team1.team))">
                                    @detail.points(team2.team)
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                    <td valign="top">
                            <!-- Capitain -->
                        <table class="bordered capitain full grey">
                            <caption>@Messages("team.detail.capitain")</caption>
                            <tr>
                                <th>@team1.team</th>
                                <th>@team2.team</th>
                            </tr>
                            <tr>
                                <td class="white">@team1.capitain.name <img src="@routes.Assets.at("ico/ok.png")"/></td>
                                <td class="white">@team2.capitain.name <img src="@routes.Assets.at("ico/ok.png")"/></td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        }
    }
}
