@(json: play.api.libs.json.JsValue,
        result: play.api.libs.json.JsValue,
        team1: model.orga.Team,
        t1: play.api.libs.json.JsValue,
        team2: model.orga.Team,
        t2: play.api.libs.json.JsValue)

@import play.api.libs.json._
@import model.orga._

@nullableAsString(json: JsValue) = {@json match {
    case JsNull =>  { }
    case JsString(v) => {@v}
    case JsNumber(n) => {@n}
    case _ => { }}}

@teamAsString(team: Team, json: JsValue, substitute: JsValue) = {
  team: @{team.shortName}
  capitain: @nullableAsString(json \ "capitain")
  joueurs:
    - @Html((json \ "players").as[JsArray].value.map(_.as[String]).mkString("\n    - "))
  doubles:
    -
      j1: @nullableAsString(json \ "d1" \ "j1")
      j2: @nullableAsString(json \ "d1" \ "j2")
    -
      j1: @nullableAsString(json \ "d2" \ "j1" )
      j2: @nullableAsString(json \ "d2" \ "j2" )
  substitute:
    j: @nullableAsString(substitute \ "j")
    out: @nullableAsString(substitute \ "out")
    match: @nullableAsString(substitute \ "match")}

@aMatch(mi:(JsValue, Int)) = {
  match@{mi._2 + 1}:
    l1: @{(mi._1 \ "leg1").as[JsNumber].value.toInt}
    l2: @{(mi._1 \ "leg2").as[JsNumber].value.toInt}
    l3: @{(mi._1 \ "leg3").as[JsNumber].value.toInt}}

@matches(matches: JsArray) = {matches: @matches.value.zipWithIndex.map(aMatch)}

<html>
    <body>
        <label>day</label>
        d@{json \ "day"}
        <br/>

        <label>file</label>
        @{team1.shortName}-@{team2.shortName}.yml
        <br/>

        <label>comment</label>
        @{json \ "comment"}
        <br/>
        <hr/>
<pre>date: @nullableAsString(result \ "date")
location: @nullableAsString(result \ "location")
team1: @teamAsString(team1, t1, t1 \ "substitute")
team2: @teamAsString(team2, t2, t2 \ "substitute")
@matches((result \ "matches").as[JsArray])</pre>
        <hr/>
    </body>
</html>
